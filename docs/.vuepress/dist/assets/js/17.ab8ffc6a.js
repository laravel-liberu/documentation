(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{312:function(e,t,a){"use strict";a.r(t);var r=a(2),o=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"dataimport"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dataimport","aria-hidden":"true"}},[e._v("#")]),e._v(" DataImport")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://www.codacy.com/app/laravel-liberu/dataImport?utm_source=github.com&utm_medium=referral&utm_content=laravel-liberu/data-import&utm_campaign=Badge_Grade",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://api.codacy.com/project/badge/Grade/b169a2f09f864cd5b274ce63008f04b9",alt:"Codacy Badge"}}),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://github.styleci.io/repos/89221336",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://github.styleci.io/repos/89221336/shield?branch=master",alt:"StyleCI"}}),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/laravel-liberu/data-import",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/laravel-liberu/data-import/license",alt:"License"}}),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/laravel-liberu/data-import",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/laravel-liberu/data-import/downloads",alt:"Total Downloads"}}),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://packagist.org/packages/laravel-liberu/data-import",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://poser.pugx.org/laravel-liberu/data-import/version",alt:"Latest Stable Version"}}),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("Incredibly powerful, efficient, unlimited number of rows,\nqueues based Excel importer dependency for "),a("a",{attrs:{href:"https://github.com/laravel-liberu/Enso",target:"_blank",rel:"noopener noreferrer"}},[e._v("Laravel Enso"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("This package works exclusively within the "),a("a",{attrs:{href:"https://github.com/laravel-liberu/Enso",target:"_blank",rel:"noopener noreferrer"}},[e._v("Enso"),a("OutboundLink")],1),e._v(" ecosystem.")]),e._v(" "),a("p",[e._v("The front end assets that utilize this api are present in the "),a("a",{attrs:{href:"https://github.com/liberu-ui/ui",target:"_blank",rel:"noopener noreferrer"}},[e._v("ui"),a("OutboundLink")],1),e._v(" package.")]),e._v(" "),a("p",[e._v("For live examples and demos, you may visit "),a("a",{attrs:{href:"https://www.liberu.co.uk",target:"_blank",rel:"noopener noreferrer"}},[e._v("liberu.co.uk"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"https://laravel-liberu.github.io/dataimport/videos/bulma_demo_01.mp4",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://laravel-liberu.github.io/dataimport/screenshots/bulma_006_thumb.png",alt:"Watch the demo"}}),a("OutboundLink")],1)]),e._v(" "),a("p",[a("sup",[e._v("click on the photo to view a short demo in compatible browsers")])]),e._v(" "),a("p",[a("a",{attrs:{href:"https://laravel-liberu.github.io/dataimport/screenshots/bulma_007.png",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://laravel-liberu.github.io/dataimport/screenshots/bulma_007_thumb.png",alt:"Screenshot"}}),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),a("p",[e._v("Comes pre-installed in Enso.")]),e._v(" "),a("h2",{attrs:{id:"features"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#features","aria-hidden":"true"}},[e._v("#")]),e._v(" Features")]),e._v(" "),a("ul",[a("li",[e._v("allows the import of "),a("strong",[e._v("big")]),e._v(" files with the number of rows only limited by the xlsx file format,\nby splitting the data in chunks and handling them on multiple queues")]),e._v(" "),a("li",[e._v("uses JSON templates to configure "),a("code",[e._v("xlsx")]),e._v(" file imports into the application, with minimum custom logic")]),e._v(" "),a("li",[e._v("import types are defined in the package configuration")]),e._v(" "),a("li",[e._v("each import type can be validated against required columns, sheets, data types and more")]),e._v(" "),a("li",[e._v("the Laravel validation is utilized for maximum reuse of existing mechanisms while custom validators can be added when necessary")]),e._v(" "),a("li",[e._v("an example import type is included by default in the package")]),e._v(" "),a("li",[e._v("uses "),a("a",{attrs:{href:"https://github.com/box/spout",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spout"),a("OutboundLink")],1),e._v(" for reading the "),a("code",[e._v("xlsx")]),e._v(" file")]),e._v(" "),a("li",[e._v("uses Laravel's queueing system and its auto-balancing features for efficient asynchronous, parallel processing")]),e._v(" "),a("li",[e._v("blocking file structure validation")]),e._v(" "),a("li",[e._v("non blocking file contents validation")]),e._v(" "),a("li",[e._v("content import issues are made available in the rejected rows summary, a downloadable "),a("code",[e._v("xlsx")]),e._v(" file with the same structure as the import file,\nwith an extra column (on each sheet) that will describe all the validation errors for each row")]),e._v(" "),a("li",[e._v("features real time import progress reporting in the UI")]),e._v(" "),a("li",[a("code",[e._v("before")]),e._v(" and "),a("code",[e._v("after")]),e._v(" hooks which are available during the importing process")]),e._v(" "),a("li",[e._v("comes with an utility ExcelSeeder class, that can be used to seed your tables using data from excel files")])]),e._v(" "),a("h2",{attrs:{id:"usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usage","aria-hidden":"true"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Publish the configuration, example classes and assets:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("php artisan vendor:publish --tag=dataimport-config")])]),e._v(" "),a("li",[a("code",[e._v("php artisan vendor:publish --tag=dataimport-examples")])])])]),e._v(" "),a("li",[a("p",[e._v("In the library "),a("code",[e._v("samples")]),e._v(" folder, "),a("code",[e._v("vendor/laravel-liberu/dataimport/samples")]),e._v(", we have included a couple of\nsample import files for you to play with. It is strongly recommended that you check out the provided samples before\nattempting to create your own importers.")])])]),e._v(" "),a("h3",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("p",[e._v("The configuration can be found/published in "),a("code",[e._v("config/liberu/imports.php")]),e._v(" and contains:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("validations")]),e._v(" - string, flag that sets whether import template validations are also executed in production,\nvalid values are "),a("code",[e._v("always")]),e._v("/"),a("code",[e._v("local")]),e._v("/"),a("code",[e._v("yourEnv")]),e._v(" | default "),a("code",[e._v("local")])]),e._v(" "),a("li",[a("code",[e._v("chunkSize")]),e._v(" - number, the number of records in a chunk. It should be adjusted for optimum performance on your machine.\nNot that the size can also be given in the import template, thus overriding the global value")]),e._v(" "),a("li",[a("code",[e._v("splittingQueue")]),e._v(" - string, the name of the queue for the chunk splitting job. Can also be set individually, for each import, in its template")]),e._v(" "),a("li",[a("code",[e._v("queues")]),e._v(" - array, the configuration for all the queues used during the import process. Note that it's good practice to have\nmore processes for the splitting queue as this is an intensive process, and it needs to keep the other queues 'busy'.\nObviously, these queues must be set up in the Laravel "),a("code",[e._v("queue")]),e._v(" configuration file.")]),e._v(" "),a("li",[a("code",[e._v("timeout")]),e._v(" - number, the Laravel job timeout for the splitting and the rejected summary report generation jobs")]),e._v(" "),a("li",[a("code",[e._v("errorColumn")]),e._v(" - string, the name of the error column used to report issues with the import rows\n(which appears in the rejected summary xlsx file)")]),e._v(" "),a("li",[a("code",[e._v("notifications")]),e._v(" - array, the list of channels used to notify the user")]),e._v(" "),a("li",[a("code",[e._v("configs")]),e._v(" - configuration array, with what's needed to hook the JSON templates to the import package:\n"),a("ul",[a("li",[a("code",[e._v("label")]),e._v(" - the label visible to the user in the interface")]),e._v(" "),a("li",[a("code",[e._v("template")]),e._v(" - the relative path to the JSON import templates")])])])]),e._v(" "),a("h4",{attrs:{id:"json-template-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-template-structure","aria-hidden":"true"}},[e._v("#")]),e._v(" JSON Template structure:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("timeout")]),e._v(", local overriding configuration for the "),a("code",[e._v("liberu.dataimport.timeout")]),e._v(" option | default is "),a("code",[e._v("60 * 4")]),e._v(" | optional")]),e._v(" "),a("li",[a("code",[e._v("sheets")]),e._v(", array of sheet configuration objects | required")])]),e._v(" "),a("p",[e._v("Note that the importer expects to find just the sheets given in the template,\nmeaning it will report an error if there are missing sheets but also if there are extra sheets.")]),e._v(" "),a("h4",{attrs:{id:"sheet-configuration-object-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sheet-configuration-object-structure","aria-hidden":"true"}},[e._v("#")]),e._v(" Sheet Configuration object structure:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("name")]),e._v(", the name of the sheet | required\n"),a("ul",[a("li",[e._v("should be lower snake cased if the sheet name contains spaces, so use "),a("code",[e._v("sale_entries")]),e._v(" instead of "),a("code",[e._v("Sale entries")])])])]),e._v(" "),a("li",[a("code",[e._v("importerClass")]),e._v(", the fully qualified importer class name | required. Here you write the import logic.")]),e._v(" "),a("li",[a("code",[e._v("validatorClass")]),e._v(", the fully qualified custom validator class name, if you are using custom validators | optional")]),e._v(" "),a("li",[a("code",[e._v("chunkSize")]),e._v(", the size of the chunk used during splitting | default is 1000 | optional")]),e._v(" "),a("li",[a("code",[e._v("columns")]),e._v(", array of column configuration objects | required")])]),e._v(" "),a("h4",{attrs:{id:"column-configuration-object-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#column-configuration-object-structure","aria-hidden":"true"}},[e._v("#")]),e._v(" Column Configuration object structure:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("name")]),e._v(", the name of the column | required\n"),a("ul",[a("li",[e._v("similar to the sheet name, column names should be lower snake cased, so use "),a("code",[e._v("mobile_phone")]),e._v(" instead of "),a("code",[e._v("Mobile phone")])])])]),e._v(" "),a("li",[a("code",[e._v("validations")]),e._v(", the desired Laravel (Request) validation that you want applied for this column")])]),e._v(" "),a("p",[e._v("Please note that the import does not continue if "),a("em",[e._v("structure")]),e._v(" errors are encountered, such as missing sheets or columns.\nIf there are no structure errors and "),a("em",[e._v("content")]),e._v(" errors are found,\nthe rows with errors are skipped and valid rows are imported.")]),e._v(" "),a("h3",{attrs:{id:"inside-the-importer-class"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inside-the-importer-class","aria-hidden":"true"}},[e._v("#")]),e._v(" Inside the importer class")]),e._v(" "),a("p",[e._v("The importer class given in the JSON template is responsible for doing the actual importing,\nonce the file has been validated.")]),e._v(" "),a("p",[e._v("Your importer class needs to implement the "),a("code",[e._v("LaravelLiberu\\DataImport\\app\\Contracts\\Importable")]),e._v(" interface\nand implement the "),a("code",[e._v("run()")]),e._v(" method.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("run")]),e._v(" method receives a row object, which you can use to implement your import logic.")]),e._v(" "),a("p",[e._v("If you need pre/post import logic for your import, you can then also implement the following interfaces:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("LaravelLiberu\\DataImport\\app\\Contracts\\AfterHook")]),e._v(" - requires that you implement the 'after' method")]),e._v(" "),a("li",[a("code",[e._v("LaravelLiberu\\DataImport\\app\\Contracts\\BeforeHook")]),e._v("- requires that you implement the 'before' method")])]),e._v(" "),a("p",[e._v("Inside the two methods you can add your extra logic.")]),e._v(" "),a("h3",{attrs:{id:"inside-the-custom-validator-class"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inside-the-custom-validator-class","aria-hidden":"true"}},[e._v("#")]),e._v(" Inside the custom validator class")]),e._v(" "),a("p",[e._v("There might be cases where it's not enough to use the Laravel Request Validation methods. For more complex scenarios you can\ncreate a custom validator class and declare it your template.")]),e._v(" "),a("p",[e._v("The validator class must extend the "),a("code",[e._v("LaravelLiberu\\DataImport\\app\\Classes\\Validators\\Validator")]),e._v(" abstract class and implement\nthe "),a("code",[e._v("run()")]),e._v(" method.")]),e._v(" "),a("p",[e._v("Here you'll have access to the parent class' "),a("code",[e._v("addError(string $error)")]),e._v(" method.\nYou may use it to add any required issues for the data that fails your custom validation logic.")]),e._v(" "),a("h3",{attrs:{id:"the-rejected-rows-summary-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-rejected-rows-summary-file","aria-hidden":"true"}},[e._v("#")]),e._v(" The rejected rows summary file")]),e._v(" "),a("p",[e._v("You will notice that the summary file has an identical structure with the import file, with the exception\nof one last column, the errors column, that is used to present the issues for each row.")]),e._v(" "),a("p",[e._v("The idea behind creating this kind of report file is for the user to be able to get a list of import issues\nin a format that allows him to quickly correct any errors in the file,\ndelete the errors column and then simply re-import the summary file.")]),e._v(" "),a("h3",{attrs:{id:"excel-seeder"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#excel-seeder","aria-hidden":"true"}},[e._v("#")]),e._v(" Excel Seeder")]),e._v(" "),a("p",[e._v("When seeding your database, you may use regular seeders and fill your tables with random data (as configured)\nbut when you have specific data, you may want to set the actual data from the beginning.\nWhile there's more than one way to achieve this, the Excel Seeder helper allows you to seed your table\nby using data provided in an excel file, through an import")]),e._v(" "),a("ul",[a("li",[e._v("basically it's a seeder adapter for a regular data import.")])]),e._v(" "),a("p",[e._v("There are multiple advantages to this:")]),e._v(" "),a("ul",[a("li",[e._v("the data is present in an excel file, and can be added and updated by almost any person")]),e._v(" "),a("li",[e._v("even after initially seeding the database, since the import is going to remain available, additional files can be later imported for updates")])]),e._v(" "),a("h4",{attrs:{id:"steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#steps","aria-hidden":"true"}},[e._v("#")]),e._v(" Steps")]),e._v(" "),a("ol",[a("li",[e._v("create a data import, following your usual flow")]),e._v(" "),a("li",[e._v("create your excel seeder class, that will be using the import you added at step 1\n"),a("ul",[a("li",[e._v("save it on the "),a("code",[e._v("database/seeds/")]),e._v(" path")]),e._v(" "),a("li",[e._v("note that your class must extend the "),a("code",[e._v("ExcelSeeder")]),e._v(" class")]),e._v(" "),a("li",[e._v("inside, add the "),a("code",[e._v("$type")]),e._v(" parameter and use for value the type of the import created at the first step")])])]),e._v(" "),a("li",[e._v("add the actual excel file containing the data to be used when seeding\n"),a("ul",[a("li",[e._v("the file should be placed on the "),a("code",[e._v("storage/app/files")]),e._v(" path")]),e._v(" "),a("li",[e._v("the name of the file needs to be the type of the import, and and must have an "),a("code",[e._v("xlsx")]),e._v(" extension")]),e._v(" "),a("li",[e._v("since you're going to be committing the file to the repository, don't forget to add it to the "),a("code",[e._v(".gitignore")]),e._v(" exclusion list")])])]),e._v(" "),a("li",[e._v("run the seed process with "),a("code",[e._v("php artisan db:seed")]),e._v(" "),a("ul",[a("li",[e._v("the seeder will run the import process & the data will be available in the database")]),e._v(" "),a("li",[e._v("you'll also be able to see the result of the import in the data imports index page")])])])]),e._v(" "),a("h2",{attrs:{id:"publishes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#publishes","aria-hidden":"true"}},[e._v("#")]),e._v(" Publishes")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("php artisan vendor:publish --tag=dataimport-config")]),e._v(" - configuration files")]),e._v(" "),a("li",[a("code",[e._v("php artisan vendor:publish --tag=dataimport-examples")]),e._v(" - example import")]),e._v(" "),a("li",[a("code",[e._v("php artisan vendor:publish --tag=dataimport-mail")]),e._v(" - the email templates")]),e._v(" "),a("li",[a("code",[e._v("php artisan vendor:publish --tag=liberu-config")]),e._v(" - a common alias for when wanting to update configuration,\nonce a newer version is released, can be used with the "),a("code",[e._v("--force")]),e._v(" flag")]),e._v(" "),a("li",[a("code",[e._v("php artisan vendor:publish --tag=liberu-mail")]),e._v(" - a common alias for when wanting to update the email templates,\nonce a newer version is released, can be used with the "),a("code",[e._v("--force")]),e._v(" flag")])]),e._v(" "),a("h2",{attrs:{id:"external-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#external-dependencies","aria-hidden":"true"}},[e._v("#")]),e._v(" External dependencies")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/box/spout",target:"_blank",rel:"noopener noreferrer"}},[e._v("Spout"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"contributions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contributions","aria-hidden":"true"}},[e._v("#")]),e._v(" Contributions")]),e._v(" "),a("p",[e._v("are welcome. Pull requests are great, but issues are good too.")]),e._v(" "),a("h2",{attrs:{id:"license"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#license","aria-hidden":"true"}},[e._v("#")]),e._v(" License")]),e._v(" "),a("p",[e._v("This package is released under the MIT license.")])])},[],!1,null,null,null);t.default=o.exports}}]);